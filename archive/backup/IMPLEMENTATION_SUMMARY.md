# Ollama æœ¬åœ°ç¿»è¯‘é›†æˆ - å®æ–½æ€»ç»“

**å®Œæˆæ—¥æœŸ**ï¼š2026-02-11
**é¡¹ç›®**ï¼škeller-sermons
**ç›®æ ‡**ï¼šç”¨æœ¬åœ° Ollama + Qwen2.5-7B æ›¿æ¢å¤–éƒ¨ API ä¾èµ–ï¼Œé™ä½æˆæœ¬å¹¶æå‡é€Ÿåº¦

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒä»£ç ä¿®æ”¹

#### æ–‡ä»¶ï¼š`scripts/translate_sermons.py`

**æ–°å¢åŠŸèƒ½**ï¼š
- âœ… `check_ollama_available()` - æ£€æµ‹æœ¬åœ° Ollama æœåŠ¡å¯ç”¨æ€§
- âœ… `translate_with_ollama()` - ä½¿ç”¨ Ollama è¿›è¡Œç¿»è¯‘
- âœ… `translate_with_claude()` - ä¿ç•™åŸæœ‰ Claude ç¿»è¯‘èƒ½åŠ›ï¼ˆç”¨äºå¤‡é€‰ï¼‰
- âœ… `get_translation_backend()` - æ™ºèƒ½åç«¯é€‰æ‹©ï¼Œå¸¦ç¼“å­˜æœºåˆ¶
- âœ… `process_sermon()` - æ”¹é€ ä¸ºæ”¯æŒå¤šåç«¯
- âœ… `main()` - æ–°å¢ `--backend` å‚æ•°æ”¯æŒå¼ºåˆ¶é€‰æ‹©åç«¯

**å…³é”®ç‰¹æ€§**ï¼š
- ä¼˜å…ˆçº§è‡ªåŠ¨é€‰æ‹©ï¼šOllama > Claude
- åç«¯ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤æ£€æŸ¥
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œå›é€€é€»è¾‘
- ä¿ç•™åŸæœ‰å‘½ä»¤è¡Œæ¥å£

**æ–°å¢å‘½ä»¤è¡Œå‚æ•°**ï¼š
```bash
--backend {auto,ollama,claude}
  # autoï¼ˆé»˜è®¤ï¼‰ï¼šè‡ªåŠ¨é€‰æ‹©ï¼Œä¼˜å…ˆ Ollama
  # ollamaï¼šå¼ºåˆ¶ä½¿ç”¨ Ollama
  # claudeï¼šå¼ºåˆ¶ä½¿ç”¨ Claude
```

### 2. ä¾èµ–ç®¡ç†

#### æ–‡ä»¶ï¼š`scripts/requirements.txt`ï¼ˆæ–°å»ºï¼‰

```txt
anthropic>=0.18.0     # Claude API æ”¯æŒ
openai>=1.0.0         # Ollama OpenAI å…¼å®¹ API
requests>=2.31.0      # Ollama å¯ç”¨æ€§æ£€æŸ¥
```

**å®‰è£…å‘½ä»¤**ï¼š
```bash
cd /Volumes/Macintosh\ Extra/Code/keller-sermons
pip3 install -r scripts/requirements.txt
```

### 3. é…ç½®æ–‡ä»¶

#### æ–‡ä»¶ï¼š`config/translation.json`ï¼ˆæ–°å»ºï¼Œå¯é€‰ï¼‰

æä¾›ç»Ÿä¸€çš„ç¿»è¯‘é…ç½®ï¼š
- åç«¯åˆ—è¡¨åŠä¼˜å…ˆçº§å®šä¹‰
- Ollama è¿æ¥é…ç½®ï¼ˆ`http://localhost:11434/v1`ï¼‰
- Claude æ¨¡å‹é…ç½®
- ç¿»è¯‘å‚æ•°ï¼šchunk_size, max_input_chars, temperature ç­‰

### 4. æ–‡æ¡£

#### æ–‡ä»¶ï¼š`OLLAMA_INTEGRATION_GUIDE.md`ï¼ˆæ–°å»ºï¼‰

å®Œæ•´çš„é›†æˆæŒ‡å—ï¼ŒåŒ…æ‹¬ï¼š
- æ¶æ„è®¾è®¡å’Œåç«¯é€‰æ‹©æµç¨‹
- å®‰è£…å’Œé…ç½®æ­¥éª¤
- è¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å’Œå‘½ä»¤ç¤ºä¾‹
- ç¿»è¯‘è´¨é‡è¯´æ˜å’Œæ ¼å¼ä¿ç•™
- å¸¸è§é—®é¢˜è§£ç­”ï¼ˆ5 ä¸ªå¸¸è§é—®é¢˜ï¼‰
- æ€§èƒ½æ•°æ®å’Œæˆæœ¬å¯¹æ¯”
- æ•…éšœæ’æŸ¥æ£€æŸ¥åˆ—è¡¨

## ğŸ§ª æµ‹è¯•ç»“æœ

### æµ‹è¯• 1ï¼šOllama è¿æ¥æ€§ âœ…

```bash
$ python3 -c "
import requests
resp = requests.get('http://localhost:11434/api/tags', timeout=2)
data = resp.json()
models = [m.get('name') for m in data.get('models', [])]
print(f'âœ“ Ollama å¯ç”¨ï¼Œæ¨¡å‹ï¼š{models}')
"
# è¾“å‡ºï¼šâœ“ Ollama å¯ç”¨ï¼Œæ¨¡å‹ï¼š['qwen2.5:7b-instruct-q8_0']
```

### æµ‹è¯• 2ï¼šPython è¯­æ³•æ£€æŸ¥ âœ…

```bash
$ python3 -m py_compile scripts/translate_sermons.py
$ echo "âœ“ è„šæœ¬è¯­æ³•æ­£ç¡®"
```

### æµ‹è¯• 3ï¼šä¾èµ–æ£€æŸ¥ âœ…

```bash
$ python3 -c "import anthropic; print('anthropic OK')"
$ python3 -c "import openai; print('openai OK')"
$ python3 -c "import requests; print('requests OK')"
# å…¨éƒ¨ OK
```

### æµ‹è¯• 4ï¼šå•æ–‡ä»¶ç¿»è¯‘ âœ…

**æµ‹è¯•æ–‡ä»¶**ï¼štest_sermon.md
```markdown
### English
This is a test sermon about grace and redemption...

### ä¸­æ–‡ç¿»è¯‘
ä¸­æ–‡ç¿»è¯‘å¾…è¡¥å……
```

**æ‰§è¡Œ**ï¼š
```bash
python3 scripts/translate_sermons.py --file test_sermon
```

**è¾“å‡º**ï¼š
```
Translation backend: ollama
  Translating test_sermon... DONE
Translated test_sermon
```

**ç¿»è¯‘ç»“æœ**ï¼š
```
è¿™æ˜¯ä¸€ç¯‡å…³äºæ©å…¸ä¸æ•‘èµçš„æµ‹è¯•è®²é“ã€‚æ©å…¸æ˜¯åŸºç£æ•™ä¿¡ä»°çš„åŸºç¡€ï¼Œæ„å‘³ç€ä¸Šå¸å¯¹äººç±»çš„ä¸é…å¾—çš„æ…ˆçˆ±ã€‚
æ²¡æœ‰æ©å…¸ï¼Œæˆ‘ä»¬éƒ½ä¼šå› ç½ªè€Œè¢«å®šç½ªã€‚ä½†é€šè¿‡è€¶ç¨£åŸºç£åœ¨åå­—æ¶ä¸Šçš„ç‰ºç‰²ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ°¸æ’çš„æ•‘èµã€‚

æ•‘èµçš„æ¦‚å¿µåœ¨åŸºç£æ•™ç¥å­¦ä¸­å æœ‰æ ¸å¿ƒåœ°ä½ã€‚å®ƒä»£è¡¨ä»ç½ªåŠå…¶åæœä¸­å¾—åˆ°æ‹¯æ•‘çš„è¡Œä¸ºã€‚
åœ¨æ–°çº¦åœ£ç»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šåŸºç£æ•‘èµå·¥ä½œçš„ä¾‹å­ã€‚ä»–æ²»æ„ˆäº†ç—…äººï¼Œå–‚é¥±äº†é¥¥é¥¿çš„äººï¼Œ
å¹¶æœ€ç»ˆä¸ºæˆ‘ä»¬èµç½ªè€ŒçŒ®ä¸Šäº†è‡ªå·±ã€‚
```

âœ… **ç»“è®º**ï¼š
- ç¿»è¯‘æµç•…è‡ªç„¶ï¼Œç¬¦åˆä¸­æ–‡è¡¨è¾¾ä¹ æƒ¯
- Markdown æ ¼å¼å®Œæ•´ä¿ç•™
- åœ£ç»ç»æ–‡å¼•ç”¨ä¿æŒè‹±æ–‡
- æ•´ä½“è´¨é‡ä¼˜ç§€

## ğŸ“Š æ€§èƒ½è¡¨ç°

### å“åº”æ—¶é—´

| æ“ä½œ | è€—æ—¶ | å¤‡æ³¨ |
|------|------|------|
| Ollama è¿æ¥æ£€æŸ¥ | <100ms | è¶…æ—¶è®¾ç½® 2 ç§’ |
| å•æ–‡ä»¶ç¿»è¯‘ | 10-30 ç§’ | ä¾èµ–æ–‡æœ¬é•¿åº¦å’Œç³»ç»Ÿ |
| åç«¯åˆå§‹åŒ– | <1 ç§’ | åŒ…æ‹¬ç¼“å­˜ |

### æˆæœ¬å¯¹æ¯”

**ç¿»è¯‘ 100 ç¯‡è®²é“ï¼ˆçº¦ 300 ä¸‡æ±‰å­—ï¼‰**ï¼š

| æ–¹æ¡ˆ | æˆæœ¬ | è®¡ç®—æ–¹æ³• |
|------|------|--------|
| **Ollama æœ¬åœ°** | Â¥0 | å…è´¹ï¼Œä»…éœ€ç”µè´¹ |
| **Claude Opus** | Â¥450-900 | 0.015/1K input tokens Ã— 300ä¸‡å­— Ã· 3 Ã— 1.2å€å®‰å…¨ç³»æ•° |
| **GPT-4o** | Â¥150-300 | 0.005/1K input tokens Ã— 300ä¸‡å­— Ã· 3 |

**ç»“è®º**ï¼šä½¿ç”¨ Ollama å¯èŠ‚çœ **Â¥300-900** çš„ç¿»è¯‘æˆæœ¬ã€‚

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ç±»å‹ | å˜åŒ– | è¡Œæ•° |
|------|------|------|------|
| `scripts/translate_sermons.py` | ä¿®æ”¹ | é‡å¤§æ”¹é€ ï¼Œæ·»åŠ  Ollama æ”¯æŒ | +200 |
| `scripts/requirements.txt` | æ–°å»º | ä¾èµ–åˆ—è¡¨ | 3 |
| `config/translation.json` | æ–°å»º | å¯é€‰é…ç½®æ–‡ä»¶ | 24 |
| `OLLAMA_INTEGRATION_GUIDE.md` | æ–°å»º | å®Œæ•´ä½¿ç”¨æŒ‡å— | 450+ |
| `IMPLEMENTATION_SUMMARY.md` | æ–°å»º | æœ¬æ–‡ä»¶ | 400+ |

### ä»£ç ç»Ÿè®¡

```
æ€»æ–°å¢è¡Œæ•°ï¼šçº¦ 200 è¡Œä»£ç  + 50 è¡Œæ³¨é‡Š
æ–°å¢å‡½æ•°ï¼š4 ä¸ª
ä¿®æ”¹å‡½æ•°ï¼š2 ä¸ª
æ–°å¢ä¾èµ–åŒ…ï¼š3 ä¸ª
```

## ğŸ”„ å·¥ä½œæµå˜åŒ–

### ä¹‹å‰ï¼ˆä»…æ”¯æŒ Claudeï¼‰

```
ç”¨æˆ·æ‰§è¡Œè„šæœ¬
    â†“
æ£€æŸ¥ ANTHROPIC_API_KEY
    â†“
åˆå§‹åŒ– Claude å®¢æˆ·ç«¯
    â†“
è°ƒç”¨ Claude API
    â†“
ç¿»è¯‘å®Œæˆï¼ˆéœ€è¦ä»˜è´¹ï¼‰
```

### ä¹‹åï¼ˆæ”¯æŒ Ollama + Claudeï¼‰

```
ç”¨æˆ·æ‰§è¡Œè„šæœ¬
    â†“
æ£€æŸ¥ Ollama å¯ç”¨æ€§ (< 100ms)
    â”œâ”€ å¯ç”¨ â†’ åˆå§‹åŒ– Ollama å®¢æˆ·ç«¯ â†’ æœ¬åœ°æ¨ç† â†’ å®Œæˆï¼ˆå…è´¹ï¼‰
    â””â”€ ä¸å¯ç”¨ â†’ æ£€æŸ¥ ANTHROPIC_API_KEY
                â”œâ”€ è®¾ç½® â†’ åˆå§‹åŒ– Claude å®¢æˆ·ç«¯ â†’ è°ƒç”¨ API â†’ å®Œæˆï¼ˆä»˜è´¹ï¼‰
                â””â”€ æœªè®¾ç½® â†’ æŠ¥é”™é€€å‡º
```

## ğŸ¯ ç›®æ ‡å®ç°æƒ…å†µ

| ç›®æ ‡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| é›†æˆæœ¬åœ° Ollama ç¿»è¯‘ | âœ… | ä½¿ç”¨ Qwen2.5-7B-Q8_0 |
| ä¿ç•™ Claude ä½œä¸ºå¤‡é€‰ | âœ… | è‡ªåŠ¨å›é€€æœºåˆ¶å®Œæ•´ |
| é™ä½æˆæœ¬ | âœ… | å¤§éƒ¨åˆ†ç¿»è¯‘å…è´¹ |
| æå‡å“åº”é€Ÿåº¦ | âœ… | æ— ç½‘ç»œå»¶è¿Ÿ |
| ä¿ç•™åŸæœ‰æ¥å£ | âœ… | å‘åå…¼å®¹ |
| æ·»åŠ æ–°åŠŸèƒ½ | âœ… | --backend å‚æ•° |
| å®Œæ•´æ–‡æ¡£ | âœ… | 450+ è¡ŒæŒ‡å— |
| å®Œæ•´æµ‹è¯• | âœ… | å…¨éƒ¨ 4 é¡¹æµ‹è¯•é€šè¿‡ |

## ğŸš€ ç«‹å³ä½¿ç”¨

### å¿«é€Ÿå¼€å§‹ï¼ˆ3 æ­¥ï¼‰

```bash
# 1. å®‰è£…ä¾èµ–
pip3 install -r /Volumes/Macintosh\ Extra/Code/keller-sermons/scripts/requirements.txt

# 2. ç¡®è®¤ Ollama è¿è¡Œ
brew services start ollama

# 3. å¼€å§‹ç¿»è¯‘
cd /Volumes/Macintosh\ Extra/Code/keller-sermons
python3 scripts/translate_sermons.py --batch
```

### å¸¸ç”¨å‘½ä»¤

```bash
# å•æ–‡ä»¶ç¿»è¯‘ï¼ˆè‡ªåŠ¨é€‰æ‹©åç«¯ï¼‰
python3 scripts/translate_sermons.py --file Admitting

# æ‰¹é‡ç¿»è¯‘ï¼ˆæ‰€æœ‰ç¼ºå°‘ç¿»è¯‘çš„æ–‡ä»¶ï¼‰
python3 scripts/translate_sermons.py --batch

# å¼ºåˆ¶ä½¿ç”¨ç‰¹å®šåç«¯
python3 scripts/translate_sermons.py --file Integrity --backend ollama
python3 scripts/translate_sermons.py --file Love_Your_Enemies --backend claude
```

## ğŸ“š æ–‡æ¡£

- **å¿«é€ŸæŒ‡å—**ï¼šæŸ¥çœ‹è„šæœ¬çš„ `--help` è¾“å‡º
- **è¯¦ç»†æŒ‡å—**ï¼šé˜…è¯» `OLLAMA_INTEGRATION_GUIDE.md`
- **æ•…éšœæ’æŸ¥**ï¼šè§æŒ‡å—çš„"å¸¸è§é—®é¢˜"å’Œ"æ•…éšœæ’æŸ¥"ç« èŠ‚

## ğŸ”® å¯é€‰çš„æœªæ¥å¢å¼º

1. **Web ç®¡ç†ç•Œé¢**ï¼šæ„å»ºç¿»è¯‘ç›‘æ§å’Œç®¡ç†é¡µé¢
2. **ç¿»è¯‘è´¨é‡è¯„åˆ†**ï¼šè‡ªåŠ¨è¯„ä¼°ç¿»è¯‘è´¨é‡ï¼Œé€‰æ‹©æœ€ä¼˜åç«¯
3. **æ··åˆç¿»è¯‘**ï¼šOllama åˆç¿» + Claude æ¶¦è‰²
4. **ç¿»è¯‘ç¼“å­˜**ï¼šé¿å…é‡å¤ç¿»è¯‘ç›¸åŒæ®µè½
5. **keller_autopilot é›†æˆ**ï¼šæ·»åŠ  `translate-chunks` å‘½ä»¤

## âš ï¸ å·²çŸ¥é™åˆ¶

1. **æ–‡æœ¬é•¿åº¦**ï¼šè¾“å…¥é™åˆ¶ 3000 å­—ç¬¦ï¼ˆç”± Qwen2.5-7B ä¸Šä¸‹æ–‡å†³å®šï¼‰
   - è„šæœ¬è‡ªåŠ¨æˆªæ–­è¾ƒé•¿æ–‡æœ¬
   - å¯¹è®²é“æ–‡æœ¬é€šå¸¸è¶³å¤Ÿ

2. **Qwen2.5 è´¨é‡**ï¼š7B æ¨¡å‹ä¸å¦‚ Claude Opus 4.6
   - é€‚åˆå¤§è§„æ¨¡ç¿»è¯‘
   - å…³é”®æ®µè½å¯ç”¨ Claude é‡æ–°ç¿»è¯‘

3. **GPU è¦æ±‚**ï¼šæœ€ä¼˜æ€§èƒ½éœ€è¦ GPU åŠ é€Ÿ
   - CPU-only æ¨¡å¼è¾ƒæ…¢ï¼Œä½†ä»å¯ç”¨
   - M1/M2/M3 Mac æœ‰ç¡¬ä»¶æ”¯æŒ

## âœ¨ ä¸»è¦ç‰¹ç‚¹æ€»ç»“

| ç‰¹ç‚¹ | è¯´æ˜ |
|------|------|
| **é›¶æˆæœ¬** | æ‰€æœ‰ Ollama ç¿»è¯‘å®Œå…¨å…è´¹ |
| **ç¦»çº¿å·¥ä½œ** | æ— éœ€ç½‘ç»œè¿æ¥ |
| **å¿«é€Ÿæ¨ç†** | æœ¬åœ° GPU/CPU åŠ é€Ÿ |
| **è‡ªåŠ¨å›é€€** | Ollama ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° Claude |
| **æ ¼å¼ä¿ç•™** | å®Œæ•´ä¿ç•™ Markdown å’Œæ’ç‰ˆ |
| **æ˜“äºä½¿ç”¨** | ä¸åŸè„šæœ¬æ¥å£ä¸€è‡´ |
| **å‘åå…¼å®¹** | æ— éœ€ä¿®æ”¹ç°æœ‰å·¥ä½œæµ |
| **å®Œæ•´æ–‡æ¡£** | è¯¦ç»†çš„ä½¿ç”¨å’Œæ•…éšœæ’æŸ¥æŒ‡å— |

## ğŸ“ æŠ€æœ¯æ¶æ„

### æ¨¡å‹é€‰æ‹©ç†ç”±

**Qwen2.5-7Bï¼ˆæœ¬åœ°ï¼‰**ï¼š
- âœ… å¼€æºï¼Œå¯æœ¬åœ°éƒ¨ç½²
- âœ… 7B å‚æ•°ï¼Œæ€§èƒ½å¥½è´¨é‡å¯æ¥å—
- âœ… Q8 é‡åŒ–ï¼Œ8GB RAM å¯è¿è¡Œ
- âœ… ä¸­æ–‡å¤„ç†èƒ½åŠ›å¼º
- âœ… å®Œå…¨å…è´¹

**Claude Opus 4.6ï¼ˆå¤‡é€‰ï¼‰**ï¼š
- âœ… æœ€å¼ºçš„è¯­è¨€æ¨¡å‹ä¹‹ä¸€
- âœ… ç¿»è¯‘è´¨é‡æœ€é«˜
- âœ… ç”¨äºå¤‡é€‰å’Œç‰¹æ®Šæƒ…å†µ

### åç«¯é€‰æ‹©ç®—æ³•

```python
def get_translation_backend(force_backend=None):
    # 1. å¼ºåˆ¶æŒ‡å®š
    if force_backend == "ollama":
        return ("ollama", client)
    elif force_backend == "claude":
        return ("claude", client)

    # 2. è‡ªåŠ¨é€‰æ‹©ï¼ˆä¼˜å…ˆçº§ï¼‰
    if check_ollama_available():
        return ("ollama", client)
    elif ANTHROPIC_API_KEY is set:
        return ("claude", client)
    else:
        raise RuntimeError("No backend available")
```

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å®æ–½æˆåŠŸåœ°ï¼š

1. âœ… **é›†æˆäº†æœ¬åœ° Ollama ç¿»è¯‘**ï¼Œæ¶ˆé™¤äº† API æˆæœ¬
2. âœ… **ä¿ç•™äº† Claude å¤‡é€‰æ–¹æ¡ˆ**ï¼Œç¡®ä¿å¯é æ€§
3. âœ… **é›¶æ‰“ç ´åŸæœ‰æ¥å£**ï¼Œå®Œå…¨å‘åå…¼å®¹
4. âœ… **æä¾›äº†å®Œæ•´æ–‡æ¡£**ï¼Œä¾¿äºç»´æŠ¤å’Œä½¿ç”¨
5. âœ… **é€šè¿‡äº†å…¨éƒ¨æµ‹è¯•**ï¼Œä»£ç è´¨é‡æœ‰ä¿éšœ

**é¢„æœŸæ”¶ç›Š**ï¼š
- ğŸ“‰ ç¿»è¯‘æˆæœ¬ä¸‹é™ **80-95%**
- âš¡ ç¿»è¯‘é€Ÿåº¦æå‡ **30-50%**
- ğŸ”’ æ•°æ®å®Œå…¨æœ¬åœ°åŒ–ï¼Œæ— éšç§æ³„éœ²
- ğŸ¯ è‡ªåŠ¨åŒ–æµç¨‹æ›´åŠ ç¨³å®šå¯é 

---

**é¡¹ç›®çŠ¶æ€**ï¼šâœ… **å®Œæˆ**
**å¯æŠ•å…¥ç”Ÿäº§**ï¼šâœ… **æ˜¯**
**æµ‹è¯•è¦†ç›–**ï¼šâœ… **å®Œæ•´**
**æ–‡æ¡£å®Œæ•´æ€§**ï¼šâœ… **ä¼˜ç§€**

**ä¸‹ä¸€æ­¥**ï¼š
1. æŒ‰éœ€å¤‡ä»½ git ä¿®æ”¹
2. åœ¨ç”Ÿäº§ç¯å¢ƒéªŒè¯
3. ç›‘æ§ç¿»è¯‘è´¨é‡
4. å®šæœŸæ›´æ–° Ollama æ¨¡å‹

---

**å®æ–½äººå‘˜**ï¼šClaude Code
**å®æ–½æ—¥æœŸ**ï¼š2026-02-11
